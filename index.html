<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Form</title>
</head>
<body>
    <h1>Room Form</h1>
    <form id="roomForm">
        <label for="room">Room Name:</label>
        <input type="text" id="room" name="room" required>
        <button type="submit">Submit</button>
    </form>

    <script>
        document.getElementById('roomForm').addEventListener('submit', async function(event) {
            event.preventDefault();
            const roomName = document.getElementById('room').value;

            // Get the current content of rooms.txt
            let currentContent = '';
            try {
                const response = await fetch('https://api.github.com/repos/chedi-ryuma/a.github.io/contents/rooms.txt');
                const fileData = await response.json();
                if (response.ok && fileData.content) {
                    currentContent = atob(fileData.content);
                }
            } catch (error) {
                console.error('Error fetching current content:', error);
            }

            // Append the new room name to the current content
            const updatedContent = currentContent + '\n' + roomName;

            const data = {
                message: "Add new room",
                content: btoa(updatedContent),
                committer: {
                    name: "Your Name",
                    email: "your-email@example.com"
                },
                sha: fileData.sha // Needed for updating an existing file
            };

            try {
                const response = await fetch('https://api.github.com/repos/chedi-ryuma/a.github.io/contents/rooms.txt', {
                    method: 'PUT',
                    headers: {
                        'Authorization': 'token YOUR_GITHUB_TOKEN',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    alert('Room name saved successfully!');
                } else {
                    alert('Failed to save room name.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred.');
            }
        });
    </script>
</body>
</html>
